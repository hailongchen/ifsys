<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gigold.pay.autotest.dao.IfSysMockDAO">

	<resultMap type="com.gigold.pay.autotest.bo.IfSysMock" id="ifSysMockResultMap">
		<id property="id" column="ID" />
		<result property="ifId" column="IF_ID" />
		<result property="rspCode" column="RSP_CODE" />
		<result property="requestJson" column="REQUEST_JSON" />
		<result property="responseJson" column="RESPONSE_JSON" />
		<result property="realRspCode" column="REAL_RSP_CODE" />
		<result property="realResponseJson" column="REAL_RESPONSE_JSON" />
		<result property="testResult" column="TEST_RESULT" />
	</resultMap>

	<insert id="addIfSysMock" parameterType="com.gigold.pay.autotest.bo.IfSysMock"
		useGeneratedKeys="true" keyProperty="id">
        <![CDATA[  
        insert into
        T_IF_AUTO_MOCK
        (
         IF_ID,
         RSP_CODE,
         REQUEST_JSON,
         RESPONSE_JSON
        )
        values(
        #{ifId},
        #{rspCode},
        #{requestJson},
        #{responseJson})
    ]]>
	</insert>
	 <!-- 修改模拟数据  -->
	<update id="updateIfSysMock" parameterType="com.gigold.pay.autotest.bo.IfSysMock">
		update T_IF_AUTO_MOCK
		<set>
		<if test="rspCode!=null and rspCode!=''">
				RSP_CODE=#{rspCode},
			</if>
			<if test="requestJson!=null and requestJson!=''">
				REQUEST_JSON=#{requestJson},
			</if>
			<if test="responseJson!=null and responseJson!=''">
				RESPONSE_JSON=#{responseJson},
			</if>
			<if test="realRspCode!=null and realRspCode!=''">
				REAL_RSP_CODE=#{realRspCode},
			</if>
			<if test="realResponseJson!=null and realResponseJson!=''">
				REAL_RESPONSE_JSON=#{realResponseJson},
			</if>
			<if test="testResult!=null and testResult!=''">
				TEST_RESULT=#{testResult},
			</if>
		</set>
		where ID =#{id}
	</update>
	
	 <!-- 根据ID删除模拟数据  -->
	<update id="deleteIfSysMockById" parameterType="int">
		update T_IF_AUTO_MOCK
		set STATUS='N'
		where ID =#{id}
	</update>
	<!-- 根据IF_ID删除模拟数据  -->
	<update id="deleteIfSysMockByIfId" parameterType="int">
		update T_IF_AUTO_MOCK
		set STATUS='N'
		where IF_ID =#{ifId}
	</update>
	
	<!--获取测试数据维护列表信息  可以根据接口ID 或者测试数据ID查询-->
	<select id="getIfSysMock" parameterType="com.gigold.pay.autotest.bo.IfSysMock"
		resultType="java.util.Map">
		select ii.ID,
		ii.IF_NAME,
		ii.IF_DESC,
		(select sys.IF_SYS_NAME from T_IF_SYSTEM sys where sys.id=ii.IF_SYS_ID)
		SYS_NAME,
		(select pro.IF_PRO_NAME from T_IF_PRO pro where pro.id=ii.IF_PRO_ID and
		pro.IF_SYS_ID=ii.IF_SYS_ID) PRO_NAME,
		(select sys.ADDRESS_URL from T_IF_SYSTEM sys where sys.id=ii.IF_SYS_ID)
		ADDRESS_URL,
		mm.RSP_CODE,
		mm.REQUEST_JSON,
		mm.RESPONSE_JSON,
		mm.TEST_RESULT,
		mm.REAL_RESPONSE_JSON,
		mm.REAL_RSP_CODE
		from T_IF_INTERFACE ii left join T_IF_AUTO_MOCK mm on ii.ID=mm.IF_ID
		where ii.ISVALID='Y'
		<if test="ifId!=null and ifId!=''">
		and ii.ID=#{ifId}
		</if>
		<if test="id!=null and id!=''">
		and mm.ID=#{id}
		</if>
	</select>

	
	<!-- 分页获取接口基本信息 列表页 -->
	<select id="getIfSysById" resultType="java.util.Map">
		<![CDATA[  
		select ID,
		ii.IF_NAME,
		ii.IF_DESC,
		ii.IF_URL,
		(select sys.IF_SYS_NAME from T_IF_SYSTEM sys where sys.id=ii.IF_SYS_ID)
		SYS_NAME,
		(select pro.IF_PRO_NAME from T_IF_PRO pro where pro.id=ii.IF_PRO_ID and
		pro.IF_SYS_ID=ii.IF_SYS_ID) PRO_NAME,
		(select sys.ADDRESS_URL from T_IF_SYSTEM sys where sys.id=ii.IF_SYS_ID)
		ADDRESS_URL
		from T_IF_INTERFACE ii
		where ii.ISVALID='Y'
		  ]]>
	</select>
	
	<!-- 根据接口ID获取测试数据信息  编辑页,新增页 -->
	<select id="getMockInfoByIfId" parameterType="int" resultMap="ifSysMockResultMap">
     <![CDATA[ 
		select ID,
		IF_ID,
		RSP_CODE,
		REQUEST_JSON,
		RESPONSE_JSON,
		REAL_RSP_CODE,
		REAL_RESPONSE_JSON,
		TEST_RESULT
		from T_IF_AUTO_MOCK
		where IF_ID=#{ifId}
		and STATUS='Y'
		 
      ]]>
	</select>

</mapper>
 
 
 
 
 
 